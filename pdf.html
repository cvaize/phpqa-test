<html>

<head>
    <!-- The offical release-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.5.207/pdf.js"> </script>
</head>

<body>
<input type="file" id="file">
<script>
    var inputElement = document.querySelector('#file');
    //Step 1: Get the file from the input element
    inputElement.onchange = function(event) {

        //It is important that you use the file and not the filepath (The file path won't work because of security issues)
        var file = event.target.files[0];

        var fileReader = new FileReader();

        fileReader.onload = function() {

            var typedarray = new Uint8Array(this.result);

            //replaced the old function with the new api
            const loadingTask = pdfjsLib.getDocument(typedarray);
            loadingTask.promise.then(pdf => {
                console.log(pdf)
                var maxPages = pdf.numPages;
                for (var j = 1; j <= maxPages; j++) {
                    var page = pdf.getPage(j);

                    page.then(function(page) { // add page promise
                        var textContent = page.getTextContent();
                        textContent.then(function(text) { // add page promise
                            console.log(text)
                        })
                    })
                }
                // The document is loaded here...
            });

        };
        //Step 3:Read the file as ArrayBuffer
        fileReader.readAsArrayBuffer(file);

    }

</script>
</body>

</html>